<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Lab 24: Basins of Attraction &#8212; Math 495R EMC2 Python Labs</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="_static/material.css?v=79c92029" />
    <script src="_static/documentation_options.js?v=6fefd858"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Lab 23: Finding Areas of Arbitrary Polygons" href="lab23.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#lab24" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Math 495R EMC2 Python Labs"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Winter EMC2 Labs</span>
          <span class="md-header-nav__topic"> Lab 24: Basins of Attraction </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Math 495R EMC2 Python Labs</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Math 495R EMC2 Python Labs" class="md-nav__button md-logo">
      
        <img src="_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="Math 495R EMC2 Python Labs">Winter EMC2 Labs</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="SQLlab.html" class="md-nav__link">Lab 0: An Introduction to SQL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab01.html" class="md-nav__link">Lab 1: Introduction to Plotting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab02.html" class="md-nav__link">Lab 2: Introduction to Plotting and Sequences</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab03.html" class="md-nav__link">Lab 3: Introduction to Space Curves</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab04.html" class="md-nav__link">Lab 4: Searching in a Sorted List</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab05.html" class="md-nav__link">Lab 5: Planes, Trains and Automobiles</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab06.html" class="md-nav__link">Lab 6: Sorting and Complexity of Algorithms</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab07.html" class="md-nav__link">Lab 7: Introduction to Series</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab08.html" class="md-nav__link">Lab 8: Plotting Surfaces in 3-D</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab09.html" class="md-nav__link">Lab 9: Symbolic Python and Partial Differentiation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab10.html" class="md-nav__link">Lab 10: A Very Basic Program</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab11.html" class="md-nav__link">Lab 11: Root Finding and Newtonâ€™s Method</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab12.html" class="md-nav__link">Lab 12: One-dimensional Optimization and Gradient Descent</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab13.html" class="md-nav__link">Lab 13: Exploring Sequences and Limit Points</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab14.html" class="md-nav__link">Lab 14: Riemann Sums</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab15.html" class="md-nav__link">Lab 15: Monte Carlo Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab16.html" class="md-nav__link">Lab 16: Geometry in Higher Dimensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab17.html" class="md-nav__link">Lab 17: Rearrangements of Conditionally Convergent Series</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab18.html" class="md-nav__link">Lab 18: K-Means Clustering</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab19.html" class="md-nav__link">Lab 19: Plotting Vector Valued Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab20.html" class="md-nav__link">Lab 20: Approximate Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab21.html" class="md-nav__link">Lab 21: Iterating Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab22.html" class="md-nav__link">Lab 22: Fractals with Turtle</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab23.html" class="md-nav__link">Lab 23: Finding Areas of Arbitrary Polygons</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Lab 24: Basins of Attraction </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Lab 24: Basins of Attraction</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lab24--page-root" class="md-nav__link">Lab 24: Basins of Attraction</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#task-1" class="md-nav__link">Task 1</a>
        </li>
        <li class="md-nav__item"><a href="#task-2a" class="md-nav__link">Task 2a</a>
        </li>
        <li class="md-nav__item"><a href="#task-2b" class="md-nav__link">Task 2b</a>
        </li>
        <li class="md-nav__item"><a href="#basins-of-attraction" class="md-nav__link">Basins of Attraction</a>
        </li>
        <li class="md-nav__item"><a href="#task-3" class="md-nav__link">Task 3</a>
        </li>
        <li class="md-nav__item"><a href="#task-4a" class="md-nav__link">Task 4a</a>
        </li>
        <li class="md-nav__item"><a href="#task-4b" class="md-nav__link">Task 4b</a>
        </li>
        <li class="md-nav__item"><a href="#task-4c" class="md-nav__link">Task 4c</a>
        </li>
        <li class="md-nav__item"><a href="#task-4d" class="md-nav__link">Task 4d</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/lab24.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lab24--page-root" class="md-nav__link">Lab 24: Basins of Attraction</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#task-1" class="md-nav__link">Task 1</a>
        </li>
        <li class="md-nav__item"><a href="#task-2a" class="md-nav__link">Task 2a</a>
        </li>
        <li class="md-nav__item"><a href="#task-2b" class="md-nav__link">Task 2b</a>
        </li>
        <li class="md-nav__item"><a href="#basins-of-attraction" class="md-nav__link">Basins of Attraction</a>
        </li>
        <li class="md-nav__item"><a href="#task-3" class="md-nav__link">Task 3</a>
        </li>
        <li class="md-nav__item"><a href="#task-4a" class="md-nav__link">Task 4a</a>
        </li>
        <li class="md-nav__item"><a href="#task-4b" class="md-nav__link">Task 4b</a>
        </li>
        <li class="md-nav__item"><a href="#task-4c" class="md-nav__link">Task 4c</a>
        </li>
        <li class="md-nav__item"><a href="#task-4d" class="md-nav__link">Task 4d</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/lab24.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="lab-24-basins-of-attraction">
<h1 id="lab24--page-root">Lab 24: Basins of Attraction<a class="headerlink" href="#lab24--page-root" title="Link to this heading">Â¶</a></h1>
<p>In <a class="reference internal" href="lab11.html"><span class="doc">Lab 11: Root Finding and Newtonâ€™s Method</span></a> you were first introduced to Newtonâ€™s method.
When there is only one solution to an equation, then for almost every initial condition we will be able to find this solution.
However, if there is more than one solution, the solution that we find is dependent on our choice of a starting point <span class="math notranslate nohighlight">\(x_0\)</span>.
For example, the function <span class="math notranslate nohighlight">\(f(x)=x^2-1\)</span> has zeros at <span class="math notranslate nohighlight">\(-1\)</span> and <span class="math notranslate nohighlight">\(1\)</span>.
If <span class="math notranslate nohighlight">\(x_0&lt;0\)</span>, then Newtonâ€™s method converges to <span class="math notranslate nohighlight">\(-1\)</span>; if <span class="math notranslate nohighlight">\(x_0 &gt; 0\)</span> then it converges to <span class="math notranslate nohighlight">\(1\)</span>.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/Basins-1.png"><img alt="_images/Basins-1.png" src="_images/Basins-1.png" style="width: 45%;"/></a>
<figcaption>
<p><span class="caption-text">Basins of attraction for <span class="math notranslate nohighlight">\(f(x) = x^2 - 1\)</span></span><a class="headerlink" href="#id1" title="Link to this image">Â¶</a></p>
</figcaption>
</figure>
<p>The regions <span class="math notranslate nohighlight">\((-\infty, 0)\)</span> and <span class="math notranslate nohighlight">\((0, \infty)\)</span> are called the <em>basins of attraction</em> of <span class="math notranslate nohighlight">\(f\)</span>.
Starting in one basin of attraction leads to finding one zero, while starting in another basin yields a different zero. In this lab, we will write code to graph the basins of attraction for a given function. This lab is an ACME lab with more explanation added where necessary.</p>
<p>The basins of attraction for <span class="math notranslate nohighlight">\(f(x) = x^2 - 1\)</span> are very straightforward, but the basins of attraction for polynomials of degree at least <span class="math notranslate nohighlight">\(3\)</span> are more interesting. We can see in the figure below that the basis of attraction for the zeros <span class="math notranslate nohighlight">\(-1\)</span> (in blue) and <span class="math notranslate nohighlight">\(1\)</span> (in green) are disconnected but share a kind of symmetry.</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/Basins-2.png"><img alt="_images/Basins-2.png" src="_images/Basins-2.png" style="width: 45%;"/></a>
<figcaption>
<p><span class="caption-text">Basins of attraction for <code class="docutils literal notranslate"><span class="pre">f(x)</span> <span class="pre">=</span> <span class="pre">x^3</span> <span class="pre">-</span> <span class="pre">x</span></code></span><a class="headerlink" href="#id2" title="Link to this image">Â¶</a></p>
</figcaption>
</figure>
<p>So far we have performed Newtonâ€™s method on functions from <span class="math notranslate nohighlight">\(\mathbb R\)</span> to <span class="math notranslate nohighlight">\(\mathbb R\)</span>.
However, the same algorithm also works on functions from <span class="math notranslate nohighlight">\(\mathbb C\)</span> to <span class="math notranslate nohighlight">\(\mathbb C\)</span>, and we may similarly find basins of attraction.
In the complex case, the basins of attraction are now <span class="math notranslate nohighlight">\(2\)</span> dimensional regions in the complex plane instead of sections on a line, so the graphs of the basins of attraction can be both interesting and beautiful.
Recall from Lab <a class="reference internal" href="lab21.html"><span class="doc">Lab 21: Iterating Functions</span></a> that every complex number <span class="math notranslate nohighlight">\(c\)</span> can be written as <span class="math notranslate nohighlight">\(c = a + bi\)</span> where <span class="math notranslate nohighlight">\(a,b\)</span> are real numbers.
We can plot <span class="math notranslate nohighlight">\(c\)</span> in a plane (the complex plane) by taking the <span class="math notranslate nohighlight">\(x\)</span>-coordinate to be the real part of <span class="math notranslate nohighlight">\(c\)</span> (which is <span class="math notranslate nohighlight">\(a\)</span>) and taking the <span class="math notranslate nohighlight">\(y\)</span>-coordinate to the be imaginary part of <span class="math notranslate nohighlight">\(c\)</span> (which is <span class="math notranslate nohighlight">\(b\)</span>).</p>
<p>To construct a plot of the basins of attraction for a complex function, we are going to use the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> library.
In all the example code given below, we will assume that <code class="docutils literal notranslate"><span class="pre">numpy</span></code> was imported as <code class="docutils literal notranslate"><span class="pre">np</span></code>.
We can easily construct a real plane with <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>-axes with the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Generally, we could then create an output list (usually <code class="docutils literal notranslate"><span class="pre">Z</span></code> as a function of <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code>) and plot all three <code class="docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, <code class="docutils literal notranslate"><span class="pre">Z</span></code> as a heatmap, contour plot, or 3D plot.
However, a complex function is a function of a single complex variable and not two real variables, even though we often think of those as equivalent.
Thus we will use <code class="docutils literal notranslate"><span class="pre">linspace</span></code> and <code class="docutils literal notranslate"><span class="pre">meshgrid</span></code> to construct <code class="docutils literal notranslate"><span class="pre">X_real</span></code> and <code class="docutils literal notranslate"><span class="pre">X_imag</span></code> and combine these to create a grid of complex points.
In the following example, the imaginary unit <span class="math notranslate nohighlight">\(i = \sqrt{-1}\)</span> is instead written as <code class="docutils literal notranslate"><span class="pre">j</span></code> in Python.
<em>Note</em>: Generally in Python you must always write a multiplication sign <code class="docutils literal notranslate"><span class="pre">*</span></code> between any number and variable, but in the case of <code class="docutils literal notranslate"><span class="pre">j</span></code> you do not. In fact, you must always have a number attached to <code class="docutils literal notranslate"><span class="pre">j</span></code> otherwise it will be assumed to be a variable.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x_real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>  <span class="c1"># Real parts.</span>
<span class="n">x_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>  <span class="c1"># Imaginary parts.</span>
<span class="n">X_real</span><span class="p">,</span> <span class="n">X_imag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">x_real</span><span class="p">,</span> <span class="n">x_imag</span><span class="p">)</span>
<span class="n">X_0</span> <span class="o">=</span> <span class="n">X_real</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span><span class="o">*</span><span class="n">X_imag</span>              <span class="c1"># Combine real and imaginary parts.</span>
</pre></div>
</div>
<p>Now we have one variable <code class="docutils literal notranslate"><span class="pre">X_0</span></code> which contains a <code class="docutils literal notranslate"><span class="pre">500</span> <span class="pre">x</span> <span class="pre">500</span></code> grid of complex numbers as opposed to two variables  <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code> which together make a grid of tuples of real numbers.
We can calculate using this grid in exactly the same way that we could with the grid of <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">Y</span></code>.
If we have some <span class="math notranslate nohighlight">\(f: \mathbb C \to \mathbb C\)</span>, we may compute an output grid by writing <code class="docutils literal notranslate"><span class="pre">Z</span> <span class="pre">=</span> <span class="pre">f(X_0)</span></code>.</p>
<section id="task-1">
<h2 id="task-1">Task 1<a class="headerlink" href="#task-1" title="Link to this heading">Â¶</a></h2>
<p>Write a function, <code class="docutils literal notranslate"><span class="pre">comspace(a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d,</span> <span class="pre">n,</span> <span class="pre">m,</span> <span class="pre">axes)</span></code>, that uses <code class="docutils literal notranslate"><span class="pre">np.linspace</span></code> and <code class="docutils literal notranslate"><span class="pre">np.meshgrid</span></code> to create an array of complex numbers distributed uniformly on <code class="docutils literal notranslate"><span class="pre">{x</span> <span class="pre">+</span> <span class="pre">1j</span> <span class="pre">*</span> <span class="pre">y:</span> <span class="pre">a</span> <span class="pre">&lt;=</span> <span class="pre">x</span> <span class="pre">&lt;=</span> <span class="pre">b,</span> <span class="pre">c</span> <span class="pre">&lt;=</span> <span class="pre">y</span> <span class="pre">&lt;=</span> <span class="pre">d}</span></code> with <code class="docutils literal notranslate"><span class="pre">n</span></code> terms on the real axis and <code class="docutils literal notranslate"><span class="pre">m</span></code> terms on the imaginary axis. Also, accept a boolean value <code class="docutils literal notranslate"><span class="pre">axes</span></code> that returns the axis grids (the outputs of <code class="docutils literal notranslate"><span class="pre">np.meshgrid</span></code>) when <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</section>
<section id="task-2a">
<h2 id="task-2a">Task 2a<a class="headerlink" href="#task-2a" title="Link to this heading">Â¶</a></h2>
<p>Write a function, <code class="docutils literal notranslate"><span class="pre">newton(f,</span> <span class="pre">df,</span> <span class="pre">x0,</span> <span class="pre">tol,</span> <span class="pre">maxiter)</span></code>, that implements Newtonâ€™s method and returns the solution only. If you have completed <a class="reference internal" href="lab11.html"><span class="doc">Lab 11: Root Finding and Newtonâ€™s Method</span></a>, you are welcome to reuse that implementation of Newtonâ€™s Method.</p>
</section>
<section id="task-2b">
<h2 id="task-2b">Task 2b<a class="headerlink" href="#task-2b" title="Link to this heading">Â¶</a></h2>
<p>Vectorize your implementation of <code class="docutils literal notranslate"><span class="pre">newton(f,</span> <span class="pre">df,</span> <span class="pre">x0,</span> <span class="pre">tol,</span> <span class="pre">maxiter)</span></code> by adding <code class="docutils literal notranslate"><span class="pre">@np.vectorize(excluded={0,</span> <span class="pre">1,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">"f",</span> <span class="pre">"df",</span> <span class="pre">"tol",</span> <span class="pre">"maxiter"})</span></code> to the line directly above the function declaration. This allows your function to properly handle vector inputs.</p>
</section>
<section id="basins-of-attraction">
<h2 id="basins-of-attraction">Basins of Attraction<a class="headerlink" href="#basins-of-attraction" title="Link to this heading">Â¶</a></h2>
<p>If we repeat this, we can create many grids <code class="docutils literal notranslate"><span class="pre">X_1</span></code>, <code class="docutils literal notranslate"><span class="pre">X_2</span></code>, <code class="docutils literal notranslate"><span class="pre">X_3</span></code>, and so on until we have <code class="docutils literal notranslate"><span class="pre">k</span></code> iterations. After enough iterations, the <code class="docutils literal notranslate"><span class="pre">(i,j)</span></code> th element of <code class="docutils literal notranslate"><span class="pre">X_k</span></code> will be very near to one of the zeros of <code class="docutils literal notranslate"><span class="pre">f</span></code>, which means that using the <code class="docutils literal notranslate"><span class="pre">(i,j)</span></code> th element of <code class="docutils literal notranslate"><span class="pre">X_0</span></code> as a starting point for Newtonâ€™s method will converge to that zero. The zeros of <span class="math notranslate nohighlight">\(f(x) = x^3 - 1\)</span> are <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(-\frac{1}{2} + \frac{\sqrt{3}}{2} i\)</span>, and <span class="math notranslate nohighlight">\(-\frac{1}{2} - \frac{\sqrt{3}}{2} i\)</span>, where the last two zeros are complex. Performing Newtonâ€™s method for this function, <code class="docutils literal notranslate"><span class="pre">(i,j)</span></code> th element of <code class="docutils literal notranslate"><span class="pre">X_k</span></code> will be close to one of these zeros. We can then assign a value <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, or <code class="docutils literal notranslate"><span class="pre">2</span></code> to each element of <code class="docutils literal notranslate"><span class="pre">X_k</span></code> depending on which zero it is closest to and save these values into a new array <code class="docutils literal notranslate"><span class="pre">Y</span></code>.</p>
<p>We then have an array <code class="docutils literal notranslate"><span class="pre">Y</span></code> where all the elements are <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">2</span></code>. Plotting this array with each number corresponding to a different color gives us a plot of the basins of attraction.</p>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/Basins-Complex.png"><img alt="_images/Basins-Complex.png" src="_images/Basins-Complex.png" style="width: 45%;"/></a>
<figcaption>
<p><span class="caption-text">Basins of attraction for <span class="math notranslate nohighlight">\(f(x) = x^3 - 1\)</span></span><a class="headerlink" href="#id3" title="Link to this image">Â¶</a></p>
</figcaption>
</figure>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="_images/Basins-Complex-2.png"><img alt="_images/Basins-Complex-2.png" src="_images/Basins-Complex-2.png" style="width: 45%;"/></a>
<figcaption>
<p><span class="caption-text">Basins of attraction for <span class="math notranslate nohighlight">\(f(x) = x^3 - x\)</span></span><a class="headerlink" href="#id4" title="Link to this image">Â¶</a></p>
</figcaption>
</figure>
<div class="admonition-note admonition">
<p class="admonition-title">Note</p>
<p>Notice that in some portions of the first figure, whenever red and blue try to come together, a patch of green appears between. This behavior repeats on an infinitely small scale, producing a fractal. Because it arises from Newtonâ€™s method, this kind of fractal is called a <em>Newton fractal</em>.</p>
<p>Newton fractals show that the long-term behavior of Newtonâ€™s method is <em>extremely</em> sensitive to the initial guess <span class="math notranslate nohighlight">\(x_0\)</span>. Changing <span class="math notranslate nohighlight">\(x_0\)</span> by a small amount can change the output of Newtonâ€™s method in a seemingly random way. This phenomenon is called <em>chaos</em> in mathematics.</p>
</div>
</section>
<section id="task-3">
<h2 id="task-3">Task 3<a class="headerlink" href="#task-3" title="Link to this heading">Â¶</a></h2>
<p>Write a function, <code class="docutils literal notranslate"><span class="pre">basins(f,</span> <span class="pre">df,</span> <span class="pre">X,</span> <span class="pre">zeros)</span></code>, that finds the basins of attraction for <code class="docutils literal notranslate"><span class="pre">X</span></code> by running Newtonâ€™s method on <code class="docutils literal notranslate"><span class="pre">X</span></code> for <code class="docutils literal notranslate"><span class="pre">f,</span> <span class="pre">df</span></code> and finding the indices of the zeros that are closest to the output.</p>
<p>Hint: Consider using <code class="docutils literal notranslate"><span class="pre">np.abs</span></code> and <code class="docutils literal notranslate"><span class="pre">np.argmin</span></code> (with <code class="docutils literal notranslate"><span class="pre">axis=0</span></code>) and <code class="docutils literal notranslate"><span class="pre">np.expand_dims</span></code> to ensure array broadcasting functions properly.</p>
</section>
<section id="task-4a">
<h2 id="task-4a">Task 4a<a class="headerlink" href="#task-4a" title="Link to this heading">Â¶</a></h2>
<p>Using all the functions you have made so far, write a function, <code class="docutils literal notranslate"><span class="pre">plot_basins(f,</span> <span class="pre">df,</span> <span class="pre">zeros,</span> <span class="pre">bounds,</span> <span class="pre">res)</span></code>, that plots the basins of attraction, using <code class="docutils literal notranslate"><span class="pre">plt.pcolormesh</span></code> (with <code class="docutils literal notranslate"><span class="pre">cmap="brg"</span></code>), of <code class="docutils literal notranslate"><span class="pre">f</span></code> applied to the complex region defined by <code class="docutils literal notranslate"><span class="pre">bounds</span></code> and <code class="docutils literal notranslate"><span class="pre">res</span></code> where <code class="docutils literal notranslate"><span class="pre">bounds</span></code> is a tuple containing <code class="docutils literal notranslate"><span class="pre">(a,</span> <span class="pre">b,</span> <span class="pre">c,</span> <span class="pre">d)</span></code> and <code class="docutils literal notranslate"><span class="pre">res</span></code> is the number of points to generate for each axis.</p>
</section>
<section id="task-4b">
<h2 id="task-4b">Task 4b<a class="headerlink" href="#task-4b" title="Link to this heading">Â¶</a></h2>
<p>Use your code from the previous exercise to visualize the basins of attraction for <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">x</span> <span class="pre">**</span> <span class="pre">3</span> <span class="pre">-</span> <span class="pre">1</span></code> on <code class="docutils literal notranslate"><span class="pre">{x</span> <span class="pre">+</span> <span class="pre">yi:</span> <span class="pre">-1.5</span> <span class="pre">&lt;=</span> <span class="pre">x,</span> <span class="pre">y</span> <span class="pre">&lt;=</span> <span class="pre">1.5}</span></code> with <code class="docutils literal notranslate"><span class="pre">res=500</span></code>.</p>
</section>
<section id="task-4c">
<h2 id="task-4c">Task 4c<a class="headerlink" href="#task-4c" title="Link to this heading">Â¶</a></h2>
<p>Use your code from the previous exercise to visualize the basins of attraction for <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">x</span> <span class="pre">**</span> <span class="pre">3</span> <span class="pre">-</span> <span class="pre">x</span></code> on <code class="docutils literal notranslate"><span class="pre">{x</span> <span class="pre">+</span> <span class="pre">yi:</span> <span class="pre">-1.5</span> <span class="pre">&lt;=</span> <span class="pre">x,</span> <span class="pre">y</span> <span class="pre">&lt;=</span> <span class="pre">1.5}</span></code> with <code class="docutils literal notranslate"><span class="pre">res=500</span></code>.</p>
</section>
<section id="task-4d">
<h2 id="task-4d">Task 4d<a class="headerlink" href="#task-4d" title="Link to this heading">Â¶</a></h2>
<p>Use your code to plot the Newton fractal (basins of attraction) for a function of your choice.</p>
<p>If you wish to use functions that are not polynomials, make sure to use NumPyâ€™s version of the function instead of the <code class="docutils literal notranslate"><span class="pre">math</span></code> libraryâ€™s. For example, use <code class="docutils literal notranslate"><span class="pre">np.sin</span></code> instead of <code class="docutils literal notranslate"><span class="pre">math.sin</span></code> since the first will work for complex numbers and the second will not. You are welcome to use online calculators to compute the zeros of complex functions. Change the domain variables <code class="docutils literal notranslate"><span class="pre">[r_min,</span> <span class="pre">r_max,</span> <span class="pre">i_min,</span> <span class="pre">i_max]</span></code> so that all the zeros of the function <code class="docutils literal notranslate"><span class="pre">f</span></code> are within the domain of the plot.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="lab23.html" title="Lab 23: Finding Areas of Arbitrary Polygons"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Lab 23: Finding Areas of Arbitrary Polygons </span>
              </div>
            </a>
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, Nick Andersen.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>