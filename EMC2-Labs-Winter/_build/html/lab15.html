<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Lab 15: Monte Carlo Integration &#8212; Math 495R EMC2 Python Labs</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="_static/material.css?v=79c92029" />
    <script src="_static/documentation_options.js?v=6fefd858"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lab 16: Geometry in Higher Dimensions" href="lab16.html" />
    <link rel="prev" title="Lab 14: Riemann Sums" href="lab14.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#lab15" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Math 495R EMC2 Python Labs"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Winter EMC2 Labs</span>
          <span class="md-header-nav__topic"> Lab 15: Monte Carlo Integration </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Math 495R EMC2 Python Labs</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Math 495R EMC2 Python Labs" class="md-nav__button md-logo">
      
        <img src="_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="Math 495R EMC2 Python Labs">Winter EMC2 Labs</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="SQLlab.html" class="md-nav__link">Lab 0: An Introduction to SQL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab01.html" class="md-nav__link">Lab 1: Introduction to Plotting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab02.html" class="md-nav__link">Lab 2: Introduction to Plotting and Sequences</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab03.html" class="md-nav__link">Lab 3: Introduction to Space Curves</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab04.html" class="md-nav__link">Lab 4: Searching in a Sorted List</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab05.html" class="md-nav__link">Lab 5: Planes, Trains and Automobiles</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab06.html" class="md-nav__link">Lab 6: Sorting and Complexity of Algorithms</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab07.html" class="md-nav__link">Lab 7: Introduction to Series</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab08.html" class="md-nav__link">Lab 8: Plotting Surfaces in 3-D</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab09.html" class="md-nav__link">Lab 9: Symbolic Python and Partial Differentiation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab10.html" class="md-nav__link">Lab 10: A Very Basic Program</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab11.html" class="md-nav__link">Lab 11: Root Finding and Newtonâ€™s Method</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab12.html" class="md-nav__link">Lab 12: One-dimensional Optimization and Gradient Descent</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab13.html" class="md-nav__link">Lab 13: Exploring Sequences and Limit Points</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab14.html" class="md-nav__link">Lab 14: Riemann Sums</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Lab 15: Monte Carlo Integration </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Lab 15: Monte Carlo Integration</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lab15--page-root" class="md-nav__link">Lab 15: Monte Carlo Integration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#volume-estimation" class="md-nav__link">Volume Estimation</a>
        </li>
        <li class="md-nav__item"><a href="#task-1" class="md-nav__link">Task 1</a>
        </li>
        <li class="md-nav__item"><a href="#integral-estimation" class="md-nav__link">Integral Estimation</a>
        </li>
        <li class="md-nav__item"><a href="#task-2" class="md-nav__link">Task 2</a>
        </li>
        <li class="md-nav__item"><a href="#integration-in-higher-dimensions" class="md-nav__link">Integration in Higher Dimensions</a>
        </li>
        <li class="md-nav__item"><a href="#task-3" class="md-nav__link">Task 3</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/lab15.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab16.html" class="md-nav__link">Lab 16: Geometry in Higher Dimensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab17.html" class="md-nav__link">Lab 17: Rearrangements of Conditionally Convergent Series</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab18.html" class="md-nav__link">Lab 18: K-Means Clustering</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab19.html" class="md-nav__link">Lab 19: Plotting Vector Valued Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab20.html" class="md-nav__link">Lab 20: Approximate Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab21.html" class="md-nav__link">Lab 21: Iterating Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab22.html" class="md-nav__link">Lab 22: Fractals with Turtle</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab23.html" class="md-nav__link">Lab 23: Finding Areas of Arbitrary Polygons</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab24.html" class="md-nav__link">Lab 24: Basins of Attraction</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lab15--page-root" class="md-nav__link">Lab 15: Monte Carlo Integration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#volume-estimation" class="md-nav__link">Volume Estimation</a>
        </li>
        <li class="md-nav__item"><a href="#task-1" class="md-nav__link">Task 1</a>
        </li>
        <li class="md-nav__item"><a href="#integral-estimation" class="md-nav__link">Integral Estimation</a>
        </li>
        <li class="md-nav__item"><a href="#task-2" class="md-nav__link">Task 2</a>
        </li>
        <li class="md-nav__item"><a href="#integration-in-higher-dimensions" class="md-nav__link">Integration in Higher Dimensions</a>
        </li>
        <li class="md-nav__item"><a href="#task-3" class="md-nav__link">Task 3</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/lab15.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="lab-15-monte-carlo-integration">
<h1 id="lab15--page-root">Lab 15: Monte Carlo Integration<a class="headerlink" href="#lab15--page-root" title="Link to this heading">Â¶</a></h1>
<p>Integration is challenging, even for a computer.
Although Riemann sums can give fairly accurate answers they do not always work well in higher dimensional settings. In todayâ€™s lab we will talk about another technique for numerical integration, called Monte Carlo integration.</p>
<section id="volume-estimation">
<h2 id="volume-estimation">Volume Estimation<a class="headerlink" href="#volume-estimation" title="Link to this heading">Â¶</a></h2>
<p>To give you an idea of how Monte Carlo integration works, letâ€™s consider the concrete example of a circle in <span class="math notranslate nohighlight">\(\mathbb R^2\)</span>.
It is well known that the area of a circle of radius <span class="math notranslate nohighlight">\(r\)</span> is <span class="math notranslate nohighlight">\(A=\pi r^2\)</span> â€“ in fact one way to numerically estimate <span class="math notranslate nohighlight">\(\pi\)</span> is to compute the area of the unit circle.
The way that Monte Carlo integration works is to randomly choose points in a domain whose area/volume is easy to calculate that encompasses the object in question.
For this concrete example we will randomly choose points from the square domain <span class="math notranslate nohighlight">\(\Omega = [-1,1] \times [-1,1]\)</span>. We can then estimate the area of the circle by determining the percentage of points that lie in the circle and multiplying this percentage by the total area of the sample domain gives an estimate for the area of the circle.</p>
<p>The following code samples 2000 uniformly distributed random points in <span class="math notranslate nohighlight">\(\Omega\)</span>, determines what percentage of those points are within the unit circle, then multiplies that percentage by <span class="math notranslate nohighlight">\(4\)</span> (the area of <span class="math notranslate nohighlight">\(\Omega\)</span>) to get an estimate for <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span> <span class="k">as</span> <span class="n">la</span>

<span class="go"># Get 2000 random points in the 2-D domain [-1,1]x[-1,1].</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2000</span><span class="p">))</span>

<span class="go"># Determine how many points are within the circle.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num_within</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">count_nonzero</span><span class="p">(</span><span class="n">lengths</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>

<span class="go"># Estimate the circle's area.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">4</span> <span class="o">*</span> <span class="p">(</span><span class="n">num_within</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">)</span>
<span class="go">3.198</span>
</pre></div>
</div>
<p>The estimate of the area of the circle 3.198 isnâ€™t perfect, but it only differs from the true area by about <span class="math notranslate nohighlight">\(0.0564\)</span>.
On average, increasing the number of sample points decreases the estimate error.</p>
<a class="reference internal image-reference" href="_images/monte-carlo.png"><img alt="_images/monte-carlo.png" class="align-center" src="_images/monte-carlo.png" style="width: 90%;"/></a>
</section>
<section id="task-1">
<h2 id="task-1">Task 1<a class="headerlink" href="#task-1" title="Link to this heading">Â¶</a></h2>
<p>The <span class="math notranslate nohighlight">\(n\)</span>-dimensional open unit ball is the set <span class="math notranslate nohighlight">\(U_n = \{ x \in \mathbb{R}^n : \sum_{i=1}^n x_i^2 &lt; 1 \}\)</span>. Write a function <code class="docutils literal notranslate"><span class="pre">unit_ball_vol(n,N)</span></code> that accepts an integer <span class="math notranslate nohighlight">\(n\)</span> and a keyword argument <span class="math notranslate nohighlight">\(N\)</span> defaulting to <span class="math notranslate nohighlight">\(10^4\)</span>.
Using Monte Carlo Methods, estimate the volume of <span class="math notranslate nohighlight">\(U_n\)</span> by drawing <span class="math notranslate nohighlight">\(N\)</span> points uniformly from the surrounding domain <span class="math notranslate nohighlight">\([-1, 1] \times [-1, 1] \times ... \times [-1, 1]\)</span>, counting how many fall into <span class="math notranslate nohighlight">\(U_n\)</span>. Use <code class="docutils literal notranslate"><span class="pre">np.random.uniform</span></code> for your sampling and use <code class="docutils literal notranslate"><span class="pre">np.linalg.norm</span></code> to determine if the points are within the unit ball.
Hint: the volume of the hypercube <span class="math notranslate nohighlight">\([-1,1]^n\)</span> is <span class="math notranslate nohighlight">\(2^n\)</span>.</p>
<p>When <span class="math notranslate nohighlight">\(n = 2\)</span>, this is the same experiment outlined above so your function should return an approximation of <span class="math notranslate nohighlight">\(\pi\)</span>. The volume of <span class="math notranslate nohighlight">\(U_3\)</span> is <span class="math notranslate nohighlight">\(\frac 43\pi \approx 4.18879\)</span>, and the volume of <span class="math notranslate nohighlight">\(U_4\)</span> is <span class="math notranslate nohighlight">\(\frac{1}{2}\pi^2 \approx 4.9348\)</span>. Try increasing the number of sample points <span class="math notranslate nohighlight">\(N\)</span> to see if your estimates improve.</p>
</section>
<section id="integral-estimation">
<h2 id="integral-estimation">Integral Estimation<a class="headerlink" href="#integral-estimation" title="Link to this heading">Â¶</a></h2>
<p>The strategy for estimating the area of a circle can be formulated as an integral problem. Define <span class="math notranslate nohighlight">\(f : \mathbb{R}^2 \to \mathbb{R}\)</span> by</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x) =
\begin{cases}
    1 &amp; \text{if } \sum_{i=1}^n x_i^2 &lt; 1 \text{ ($x$ is within the unit circle),} \\
    0 &amp; \text{otherwise.}
\end{cases}\end{split}\]</div>
<p>Let <span class="math notranslate nohighlight">\(\Omega = [-1, 1] \times [-1, 1]\)</span> as before. Then</p>
<div class="math notranslate nohighlight">
\[\int_{-1}^1 \int_{-1}^1 f(x, y) \, dx \, dy = \int_{\Omega} f(\mathbf x) \, dV = \pi.\]</div>
<p>To estimate the integral, we choose <span class="math notranslate nohighlight">\(N\)</span> random points <span class="math notranslate nohighlight">\(\{\mathbf x_i\}_{i=1}^N\)</span> in <span class="math notranslate nohighlight">\(\Omega\)</span>. Since <span class="math notranslate nohighlight">\(f\)</span> indicates whether or not a point lies within the unit circle, the total number of random points that lie in the circle is the sum of the <span class="math notranslate nohighlight">\(f(\mathbf x_i)\)</span>.
Then the average of these values, multiplied by the volume <span class="math notranslate nohighlight">\(V(\Omega)\)</span>, is the desired estimate:</p>
<div class="math notranslate nohighlight">
\[\int_\Omega f(\mathbf x) \, dV \approx V(\Omega) \frac 1N \sum_{i=1}^N f(\mathbf x_i).\]</div>
<p>This remarkably simple equation can be used to estimate the integral of any integrable function <span class="math notranslate nohighlight">\(f: \mathbb R^n \to \mathbb R\)</span> over any domain <span class="math notranslate nohighlight">\(\Omega \subset \mathbb R^n\)</span> and is called the general formula for <em>Monte Carlo integration</em>.</p>
<p>The intuition behind the formula above is that <span class="math notranslate nohighlight">\(\frac 1N \sum_{i=1}^N f(\mathbf x_i)\)</span> approximates the average value of <span class="math notranslate nohighlight">\(f\)</span> on <span class="math notranslate nohighlight">\(\Omega\)</span>, and multiplying the approximate average value by the volume of <span class="math notranslate nohighlight">\(\Omega\)</span> yields the approximate integral of <span class="math notranslate nohighlight">\(f\)</span> over <span class="math notranslate nohighlight">\(\Omega\)</span>. This is a little easier to see in one dimension: for a single-variable function <span class="math notranslate nohighlight">\(f: \mathbb R\to \mathbb R\)</span>, the Average Value Theorem states that the average value of <span class="math notranslate nohighlight">\(f\)</span> over an interval <span class="math notranslate nohighlight">\([a,b]\)</span> is given by</p>
<div class="math notranslate nohighlight">
\[f_{\text{avg}} = \frac{1}{b-a} \int_a^b f(x) \, dx.\]</div>
<p>Then using the approximation <span class="math notranslate nohighlight">\(f_{\text{avg}} \approx \frac 1N \sum_{i=1}^N f(x_i)\)</span>, the previous equation becomes</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x) \, dx = (b-a) f_{\text{avg}} \approx V(\Omega) \frac{1}{N}\sum_{i=1}^N f(x_i),\]</div>
<p>which is the Monte Carlo formula in one dimension.
In this setting <span class="math notranslate nohighlight">\(\Omega = [a,b]\)</span> and hence <span class="math notranslate nohighlight">\(V(\Omega) = b-a\)</span>.</p>
</section>
<section id="task-2">
<h2 id="task-2">Task 2<a class="headerlink" href="#task-2" title="Link to this heading">Â¶</a></h2>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">monte_carlo_one_dim</span></code> that accepts a function <span class="math notranslate nohighlight">\(f: \mathbb R\to \mathbb R\)</span>, bounds of integration <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, and an integer <span class="math notranslate nohighlight">\(N\)</span> defaulting to <span class="math notranslate nohighlight">\(10^4\)</span>. Use <code class="docutils literal notranslate"><span class="pre">np.random.uniform()</span></code> to sample <span class="math notranslate nohighlight">\(N\)</span> points over the interval <span class="math notranslate nohighlight">\([a,b]\)</span>, then use the Monte Carlo formula to estimate</p>
<div class="math notranslate nohighlight">
\[\int_a^b f(x) \, dx.\]</div>
<p>Test your function on the following integrals, or on other integrals that you can evaluate by hand.</p>
<div class="math notranslate nohighlight">
\[\int_{-4}^2 x^2 \, dx = 24, \qquad \int_{-2\pi}^{2\pi} \sin(x) \, dx = 0, \qquad \int_1^{10} \frac{dx}{x} = \ln(10) \approx 2.30259\]</div>
<div class="admonition-warning admonition">
<p class="admonition-title">Warning</p>
<p>Be careful not to use Monte Carlo integration to estimate integrals that do not converge.
For example, since <span class="math notranslate nohighlight">\(1/x\)</span> approaches <span class="math notranslate nohighlight">\(\infty\)</span> as <span class="math notranslate nohighlight">\(x\)</span> approaches <span class="math notranslate nohighlight">\(0\)</span> from the right, the integral</p>
<div class="math notranslate nohighlight">
\[\int_0^1 \frac{dx}{x}\]</div>
<p>does not converge. Even so, attempts at Monte Carlo integration still return a finite value. Use various numbers of sample points to see whether or not the integral estimate is converging.</p>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">N</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">7500</span><span class="p">,</span> <span class="mi">10000</span><span class="p">]:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)),</span> <span class="n">end</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span>
<span class="go">11.8451683722    25.5814419888    7.64364735049     # No convergence.</span>
</pre></div>
</div>
</section>
<section id="integration-in-higher-dimensions">
<h2 id="integration-in-higher-dimensions">Integration in Higher Dimensions<a class="headerlink" href="#integration-in-higher-dimensions" title="Link to this heading">Â¶</a></h2>
<p>The implementation of the Monte Carlo formula for a function <span class="math notranslate nohighlight">\(f: \mathbb R^n \to \mathbb R\)</span> with <span class="math notranslate nohighlight">\(n&gt;1\)</span> introduces a few tricky details, but the overall procedure is the same as in the case <span class="math notranslate nohighlight">\(n=1\)</span>. We consider only the case where <span class="math notranslate nohighlight">\(\Omega \subset \mathbb R^n\)</span> is an <span class="math notranslate nohighlight">\(n\)</span>-dimensional box <span class="math notranslate nohighlight">\([a_1,b_1] \times [a_2,b_2] \times \cdots \times [a_n,b_n]\)</span>.</p>
<ul>
<li><p>If <span class="math notranslate nohighlight">\(n=1\)</span> then <span class="math notranslate nohighlight">\(\Omega\)</span> is an interval, so <span class="math notranslate nohighlight">\(V(\Omega) = b_1 - a_1\)</span>. If <span class="math notranslate nohighlight">\(n=2\)</span> then <span class="math notranslate nohighlight">\(\Omega\)</span> is a rectangle, and hence <span class="math notranslate nohighlight">\(V(\Omega) = (b_1-a_1)(b_2-a_2)\)</span>, the product of the side lengths. The volume of a higher-dimensional box <span class="math notranslate nohighlight">\(\Omega\)</span> is also the product of the side lengths,</p>
<div class="math notranslate nohighlight">
\[V(\Omega) = \prod_{i=1}^n (b_i-a_i)\]</div>
</li>
<li><p>It is easy to sample uniformly over an interval <span class="math notranslate nohighlight">\([a,b]\)</span> with <code class="docutils literal notranslate"><span class="pre">np.random.uniform()</span></code>, or even over the <span class="math notranslate nohighlight">\(n\)</span>-dimensional cube <span class="math notranslate nohighlight">\([a,b]\times [a,b]\times \cdots \times [a,b]\)</span>. However, if <span class="math notranslate nohighlight">\(a_i \neq a_j\)</span> or <span class="math notranslate nohighlight">\(b_i \neq b_j\)</span> for any <span class="math notranslate nohighlight">\(i\neq j\)</span>, the samples need to be constructed in a slightly different way.</p>
<p>The interval <span class="math notranslate nohighlight">\([0,1]\)</span> can be transformed to the interval <span class="math notranslate nohighlight">\([a,b]\)</span> by scaling it so that it is the same length as <span class="math notranslate nohighlight">\([a,b]\)</span>, then shifting it to the appropriate location.</p>
<div class="math notranslate nohighlight">
\[[0,1] \xrightarrow{\text{scale by }b-a} [0,b-a] \xrightarrow{\text{shift by }a} [a,b]\]</div>
<p>This suggests a strategy for sampling over <span class="math notranslate nohighlight">\([a_1,b_1] \times [a_2,b_2] \times \cdots \times [a_n,b_n]\)</span>: sample uniformly from the <span class="math notranslate nohighlight">\(n\)</span>-dimensional box <span class="math notranslate nohighlight">\([0,1]\times [0,1]\times \cdots \times [0,1]\)</span>, multiply the <span class="math notranslate nohighlight">\(i\)</span>-th component of each sample by <span class="math notranslate nohighlight">\(b_i-a_i\)</span>, then add <span class="math notranslate nohighlight">\(a_i\)</span> to that component.</p>
<div class="math notranslate nohighlight">
\[[0,1]\times\cdots\times[0,1] \xrightarrow{\text{scale}} [0,b_1-a_1]\times\cdots\times[0,b_n-a_n] \xrightarrow{\text{shift}} [a_1,b_1]\times\cdots\times[a_n,b_n]\]</div>
</li>
</ul>
</section>
<section id="task-3">
<h2 id="task-3">Task 3<a class="headerlink" href="#task-3" title="Link to this heading">Â¶</a></h2>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">monte_carlo</span></code> that accepts a function <span class="math notranslate nohighlight">\(f: \mathbb R^n\to \mathbb R\)</span>, a list of lower bounds <span class="math notranslate nohighlight">\([a_1,\ldots,a_n]\)</span>, a list of upper bounds <span class="math notranslate nohighlight">\([b_1,\ldots,b_n]\)</span>, and an integer <span class="math notranslate nohighlight">\(N\)</span> defaulting to <span class="math notranslate nohighlight">\(10^4\)</span>, and estimates the integral</p>
<div class="math notranslate nohighlight">
\[\int_\Omega f(\mathbf x) \, dV,\]</div>
<p>where <span class="math notranslate nohighlight">\(\Omega = [a_1,b_1]\times\cdots\times[a_n,b_n]\)</span>.</p>
<p>Test your function on the following integrals.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\int_0^1 \int_0^1 x^2 + y^2 \, dxdy = \frac 23, &amp;\qquad \int_{-2}^1 \int_1^3 3x-4y+y^2 \, dxdy = 54 \\
\int_{-4}^4 \int_{-3}^3 \int_{-2}^2 \int_{-1}^1 x+&amp;y-wz^2 \, dxdydzdw = 0\end{split}\]</div>
<p>Note carefully how the order of integration defines the domain; in the last example, the <span class="math notranslate nohighlight">\(xyzw\)</span> domain is <span class="math notranslate nohighlight">\([-1,1] \times [-2,2] \times [-3,3] \times [-4,4]\)</span>, so the lower and upper bounds passed to your function should be <span class="math notranslate nohighlight">\([-1,-2,-3,-4]\)</span> and <span class="math notranslate nohighlight">\([1,2,3,4]\)</span>, respectively.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="lab14.html" title="Lab 14: Riemann Sums"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Lab 14: Riemann Sums </span>
              </div>
            </a>
          
          
            <a href="lab16.html" title="Lab 16: Geometry in Higher Dimensions"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Lab 16: Geometry in Higher Dimensions </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, Nick Andersen.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>