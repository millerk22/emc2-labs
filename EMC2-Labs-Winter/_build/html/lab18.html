<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Lab 18: K-Means Clustering &#8212; Math 495R EMC2 Python Labs</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="_static/material.css?v=79c92029" />
    <script src="_static/documentation_options.js?v=6fefd858"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lab 19: Plotting Vector Valued Functions" href="lab19.html" />
    <link rel="prev" title="Lab 17: Rearrangements of Conditionally Convergent Series" href="lab17.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#lab18" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Math 495R EMC2 Python Labs"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Winter EMC2 Labs</span>
          <span class="md-header-nav__topic"> Lab 18: K-Means Clustering </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Math 495R EMC2 Python Labs</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Math 495R EMC2 Python Labs" class="md-nav__button md-logo">
      
        <img src="_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="Math 495R EMC2 Python Labs">Winter EMC2 Labs</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="SQLlab.html" class="md-nav__link">Lab 0: An Introduction to SQL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab01.html" class="md-nav__link">Lab 1: Introduction to Plotting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab02.html" class="md-nav__link">Lab 2: Introduction to Plotting and Sequences</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab03.html" class="md-nav__link">Lab 3: Introduction to Space Curves</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab04.html" class="md-nav__link">Lab 4: Searching in a Sorted List</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab05.html" class="md-nav__link">Lab 5: Planes, Trains and Automobiles</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab06.html" class="md-nav__link">Lab 6: Sorting and Complexity of Algorithms</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab07.html" class="md-nav__link">Lab 7: Introduction to Series</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab08.html" class="md-nav__link">Lab 8: Plotting Surfaces in 3-D</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab09.html" class="md-nav__link">Lab 9: Symbolic Python and Partial Differentiation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab10.html" class="md-nav__link">Lab 10: A Very Basic Program</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab11.html" class="md-nav__link">Lab 11: Root Finding and Newton’s Method</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab12.html" class="md-nav__link">Lab 12: One-dimensional Optimization and Gradient Descent</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab13.html" class="md-nav__link">Lab 13: Exploring Sequences and Limit Points</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab14.html" class="md-nav__link">Lab 14: Riemann Sums</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab15.html" class="md-nav__link">Lab 15: Monte Carlo Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab16.html" class="md-nav__link">Lab 16: Geometry in Higher Dimensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab17.html" class="md-nav__link">Lab 17: Rearrangements of Conditionally Convergent Series</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Lab 18: K-Means Clustering </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Lab 18: K-Means Clustering</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lab18--page-root" class="md-nav__link">Lab 18: K-Means Clustering</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#the-k-means-algorithm" class="md-nav__link">The K-Means Algorithm</a>
        </li>
        <li class="md-nav__item"><a href="#task-1" class="md-nav__link">Task 1</a>
        </li>
        <li class="md-nav__item"><a href="#detecting-active-earthquake-regions" class="md-nav__link">Detecting Active Earthquake Regions</a>
        </li>
        <li class="md-nav__item"><a href="#task-2" class="md-nav__link">Task 2</a>
        </li>
        <li class="md-nav__item"><a href="#task-3" class="md-nav__link">Task 3</a>
        </li>
        <li class="md-nav__item"><a href="#task-4" class="md-nav__link">Task 4</a>
        </li>
        <li class="md-nav__item"><a href="#color-quantization" class="md-nav__link">Color Quantization</a>
        </li>
        <li class="md-nav__item"><a href="#task-5a" class="md-nav__link">Task 5a</a>
        </li>
        <li class="md-nav__item"><a href="#task-5b" class="md-nav__link">Task 5b</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/lab18.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab19.html" class="md-nav__link">Lab 19: Plotting Vector Valued Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab20.html" class="md-nav__link">Lab 20: Approximate Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab21.html" class="md-nav__link">Lab 21: Iterating Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab22.html" class="md-nav__link">Lab 22: Fractals with Turtle</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab23.html" class="md-nav__link">Lab 23: Finding Areas of Arbitrary Polygons</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab24.html" class="md-nav__link">Lab 24: Basins of Attraction</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lab18--page-root" class="md-nav__link">Lab 18: K-Means Clustering</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#the-k-means-algorithm" class="md-nav__link">The K-Means Algorithm</a>
        </li>
        <li class="md-nav__item"><a href="#task-1" class="md-nav__link">Task 1</a>
        </li>
        <li class="md-nav__item"><a href="#detecting-active-earthquake-regions" class="md-nav__link">Detecting Active Earthquake Regions</a>
        </li>
        <li class="md-nav__item"><a href="#task-2" class="md-nav__link">Task 2</a>
        </li>
        <li class="md-nav__item"><a href="#task-3" class="md-nav__link">Task 3</a>
        </li>
        <li class="md-nav__item"><a href="#task-4" class="md-nav__link">Task 4</a>
        </li>
        <li class="md-nav__item"><a href="#color-quantization" class="md-nav__link">Color Quantization</a>
        </li>
        <li class="md-nav__item"><a href="#task-5a" class="md-nav__link">Task 5a</a>
        </li>
        <li class="md-nav__item"><a href="#task-5b" class="md-nav__link">Task 5b</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/lab18.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="lab-18-k-means-clustering">
<h1 id="lab18--page-root">Lab 18: K-Means Clustering<a class="headerlink" href="#lab18--page-root" title="Link to this heading">¶</a></h1>
<p>One of the current areas of high interest is data science and machine learning. Machine learning can roughly be divided into three main types, supervised learning, unsupervised learning, and reinforcement learning. Unsupervised learning, or pattern recognition involves identifying useful patterns or structure from data that is unlabeled. One example of this is clustering, where the goal is to determine points that should be clustered together. The goal of this lab is to introduce the k-means algorithm, a simple and popular clustering method.</p>
<p>The objective of clustering is to find a partition of the data such that points in the same subset will be “close” according to some way of measuring. There are many different ways of measuring how close two points are but we will use the Euclidean distance introduced in your text.</p>
<p>More formally, suppose we have a collection of <span class="math notranslate nohighlight">\(\mathbb R^K\)</span>-valued observations <span class="math notranslate nohighlight">\(X = \{x_1,x_2,\ldots,x_n\}\)</span>.
Let <span class="math notranslate nohighlight">\(N\in \mathbb N\)</span> and let <span class="math notranslate nohighlight">\(\mathcal S\)</span> be the set of all <span class="math notranslate nohighlight">\(N\)</span>-partitions of <span class="math notranslate nohighlight">\(X\)</span>, where an <span class="math notranslate nohighlight">\(N\)</span>-partition is a partition with exactly <span class="math notranslate nohighlight">\(N\)</span> nonempty elements.
We can represent a typical partition in <span class="math notranslate nohighlight">\(\mathcal S\)</span> as <span class="math notranslate nohighlight">\(S = \{S_1, S_2, \ldots, S_N\}\)</span>, where</p>
<div class="math notranslate nohighlight">
\[X = \bigcup_{i=1}^N S_i\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[|S_i| &gt; 0, \qquad i = 1, 2, \ldots, N.\]</div>
<p>We seek the <span class="math notranslate nohighlight">\(N\)</span>-partition <span class="math notranslate nohighlight">\(S^*\)</span> that minimizes the within-cluster sum of squares, i.e.</p>
<div class="math notranslate nohighlight">
\[S^* = \operatorname{arg min}_{s\in \mathcal S} \sum_{i=1}^N \sum_{x_j \in S_i} \lVert x_j - \mu_i \rVert_2^2,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_i\)</span> is the mean of the elements in <span class="math notranslate nohighlight">\(S_i\)</span>, i.e.</p>
<div class="math notranslate nohighlight">
\[\mu_i = \frac{1}{|S_i|} \sum_{x_j \in S_i} x_j.\]</div>
<section id="the-k-means-algorithm">
<h2 id="the-k-means-algorithm">The K-Means Algorithm<a class="headerlink" href="#the-k-means-algorithm" title="Link to this heading">¶</a></h2>
<p>Finding the global minimizing partition <span class="math notranslate nohighlight">\(S^*\)</span> is generally intractable since the set of partitions can be very large indeed, but the <em>k-means</em> algorithm is a heuristic approach that can often provide reasonably accurate results.</p>
<p>We begin by specifying an initial cluster mean <span class="math notranslate nohighlight">\(\mu_i^{(1)}\)</span> for each <span class="math notranslate nohighlight">\(i=1,\ldots,N\)</span> (this can be done by random initialization, or according to some heuristic). For each iteration, we adopt the following procedure. Given a current set of cluster means <span class="math notranslate nohighlight">\(\mu^{(t)}\)</span>, we find a partition <span class="math notranslate nohighlight">\(S^{(t)}\)</span> of the observations such that</p>
<div class="math notranslate nohighlight">
\[S_i^{(t)} = \{ x_j : \lVert x_j - \mu_i^{(t)} \rVert_2^2 \leq \lVert x_j - \mu_\ell^{(t)} \rVert_2^2, \ell = 1, \ldots, N \}.\]</div>
<p>We then update our cluster means by computing for each <span class="math notranslate nohighlight">\(i=1,\ldots,N\)</span>.
We continue to iterate in this manner until the partition ceases to change.</p>
<p>The figure below shows two different clusterings of the iris data produced by the <em>k-means</em> algorithm.
Note that the quality of the clustering can depend heavily on the initial cluster means.
We can use the within-cluster sum of squares as a measure of the quality of a clustering (a lower sum of squares is better).
Where possible, it is advisable to run the clustering algorithm several times, each with a different initialization of the means, and keep the best clustering.
Note also that it is possible to have very slow convergence.
Thus, when implementing the algorithm, it is a good idea to terminate after some specified maximum number of iterations.</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/kmeans-iris.png"><img alt="_images/kmeans-iris.png" src="_images/kmeans-iris.png" style="width: 95%;"/></a>
<figcaption>
<p><span class="caption-text">Two different K-Means clusterings for the iris dataset. Notice that the clustering on the left predicts the flower species to a high degree of accuracy, while the clustering on the right is less effective.</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The algorithm can be summarized as follows.</p>
<ol class="arabic simple">
<li><p>Choose <span class="math notranslate nohighlight">\(k\)</span> initial cluster centers.</p></li>
<li><p>For <span class="math notranslate nohighlight">\(i=0, \ldots, \texttt{max_iter}\)</span>,</p>
<ol class="loweralpha simple">
<li><p>Assign each data point to the cluster center that is closest, forming <span class="math notranslate nohighlight">\(k\)</span> clusters.</p></li>
<li><p>Recompute the cluster centers as the means of the new clusters.</p></li>
<li><p>If the old cluster centers and the new cluster centers are sufficiently close, terminate early.</p></li>
</ol>
</li>
</ol>
<p>Those students planning on enrolling in the ACME program or who are completing a degree in computer science will likely have the opportunity to code up the k-means algorithm as part of the program.
For this lab we will use the built in version of k-means clustering that comes with the <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> package.</p>
</section>
<section id="task-1">
<h2 id="task-1">Task 1<a class="headerlink" href="#task-1" title="Link to this heading">¶</a></h2>
<p>The K-means clustering algorithm is an unsupervised classification model. <a class="reference external" href="https://colab.research.google.com/drive/1GtrgUCOU4LdT-0arXn1S12uWeGMM2YVX?usp=sharing">You will find an implementation of this algorithm here</a>. Read through this implementation and the usage example to understand how to use this implementation of the K-means clustering algorithm. Be sure to submit the unmodified starter code for this task to receive credit.</p>
</section>
<section id="detecting-active-earthquake-regions">
<h2 id="detecting-active-earthquake-regions">Detecting Active Earthquake Regions<a class="headerlink" href="#detecting-active-earthquake-regions" title="Link to this heading">¶</a></h2>
<p>Suppose we are interested in learning about which regions are prone to experience frequent earthquake activity.
We could make a map of all earthquakes over a given period of time and examine it ourselves, but this, as an unsupervised learning problem, can be solved using our k-means clustering tool.</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/earthquakes.png"><img alt="_images/earthquakes.png" src="_images/earthquakes.png" style="width: 95%;"/></a>
<figcaption>
<p><span class="caption-text">Earthquake epicenters over a 6 month period.</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>The file <code class="docutils literal notranslate"><span class="pre">earthquake_coordinates.npy</span></code> contains earthquake data throughout the world from January 2010 through June 2010.
Each row represents a different earthquake; the columns are scaled longitude and latitude measurements.
We want to cluster this data into active earthquake regions.
For this task, we might think that we can regard any epicenter as a point in <span class="math notranslate nohighlight">\(\mathbb R^2\)</span> with coordinates being their latitude and longitude.
This, however, would be incorrect, because the earth is not flat.
Instead, latitude and longitude should be viewed in spherical coordinates in <span class="math notranslate nohighlight">\(\mathbb R^3\)</span>, which could then be clustered.</p>
<p>A simple way to accomplish this transformation is to first transform the latitude and longitude values to spherical coordinates, and then to Euclidean coordinates.
Recall that a spherical coordinate in <span class="math notranslate nohighlight">\(\mathbb R^3\)</span> is a triple <span class="math notranslate nohighlight">\((r,\theta,\varphi)\)</span>, where <span class="math notranslate nohighlight">\(r\)</span> is the distance from the origin, <span class="math notranslate nohighlight">\(\theta\)</span> is the radial angle in the <span class="math notranslate nohighlight">\(xy\)</span>-plane from the <span class="math notranslate nohighlight">\(x\)</span>-axis, and <span class="math notranslate nohighlight">\(\varphi\)</span> is the angle from the <span class="math notranslate nohighlight">\(z\)</span>-axis.
In our earthquake data, once the longitude is converted to radians it is an appropriate <span class="math notranslate nohighlight">\(\theta\)</span> value; the latitude needs to be offset by <span class="math notranslate nohighlight">\(90\)</span> degrees, then converted to radians to obtain <span class="math notranslate nohighlight">\(\varphi\)</span>.
For simplicity we can take <span class="math notranslate nohighlight">\(r=1\)</span>, since the Earth is roughly a sphere.
We can then transform to Euclidean coordinates using the following relationships.</p>
<div class="math notranslate nohighlight">
\[\theta = \frac{\pi}{180} \times \text{longitude} \qquad \varphi = \frac{\pi}{180}\times (90-\text{latitude})\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}r &amp;= \sqrt{x^2+y^2+z^2} \qquad &amp;x=r\sin\varphi\cos\theta \\
\varphi &amp;= \arccos \frac{z}{r} &amp;y= r\sin\varphi\sin\theta \\
\theta &amp;= \arctan \frac yx  &amp;z=r\cos\varphi\end{split}\]</div>
<p>There is one last issue to solve before clustering.
Each earthquake data point has norm <span class="math notranslate nohighlight">\(1\)</span> in Euclidean coordinates, since it lies on the surface of a sphere of radius <span class="math notranslate nohighlight">\(1\)</span>.
Therefore, the cluster centers should also have norm <span class="math notranslate nohighlight">\(1\)</span>.
Otherwise, the means can’t be interpreted as locations on the surface of the earth, and the k-means algorithm will struggle to find good clusters.
A solution to this problem is to normalize the mean vectors at each iteration, so that they are always unit vectors.</p>
</section>
<section id="task-2">
<h2 id="task-2">Task 2<a class="headerlink" href="#task-2" title="Link to this heading">¶</a></h2>
<p>We will be using the K-means algorithm to classify earthquake data; however, this data is recorded in latitudinal and longitudinal coordinates. This is problematic as applying the 2-norm (Euclidean distance) to this coordinate system fails to yield the measures we expect to see because of distortion. As such, we must convert these coordinates to 3-dimensional Euclidean coordinates before running the K-means algorithm.</p>
<p>Write a function, <code class="docutils literal notranslate"><span class="pre">ll_to_euc(X)</span></code>, that takes an array of longitudinal and latitudinal (in that order) coordinates, <code class="docutils literal notranslate"><span class="pre">X</span></code>, and converts them to 3-dimensional Euclidean coordinates. Do this by writing and using two functions: a function, <code class="docutils literal notranslate"><span class="pre">ll_to_sph(X)</span></code>, that takes an array of longitudinal and latitudinal (in that order) coordinates, <code class="docutils literal notranslate"><span class="pre">X</span></code>, and converts them into spherical coordinates and a function, <code class="docutils literal notranslate"><span class="pre">sph_to_euc(X)</span></code>, that takes an array of spherical coordinates, <code class="docutils literal notranslate"><span class="pre">X</span></code>, and converts them into 3-dimensional Euclidean coordinates.</p>
</section>
<section id="task-3">
<h2 id="task-3">Task 3<a class="headerlink" href="#task-3" title="Link to this heading">¶</a></h2>
<p>We would still like to plot our data in longitudinal and latitudinal coordinates. As such, we need to be able to convert from 3-dimensional coordinates back to longitudinal and latitudinal coordinates.</p>
<p>Write a function, <code class="docutils literal notranslate"><span class="pre">euc_to_ll(X)</span></code>, that takes an array of 3-dimensional Euclidean coordinates, <code class="docutils literal notranslate"><span class="pre">X</span></code>, and converts them to longitudinal and latitudinal (in that order) coordinates. Do this by writing and using two functions: a function, <code class="docutils literal notranslate"><span class="pre">euc_to_sph(X)</span></code>, that takes an array of 3-dimensional Euclidean coordinates, <code class="docutils literal notranslate"><span class="pre">X</span></code>, and converts them into spherical coordinates and a function, <code class="docutils literal notranslate"><span class="pre">sph_to_ll(X)</span></code>, that takes an array of spherical (in that order) coordinates, <code class="docutils literal notranslate"><span class="pre">X</span></code>, and converts them into longitudinal and latitudinal coordinates.</p>
</section>
<section id="task-4">
<h2 id="task-4">Task 4<a class="headerlink" href="#task-4" title="Link to this heading">¶</a></h2>
<p>Use your code from the previous tasks alongside the provided K-means code to write a function, <code class="docutils literal notranslate"><span class="pre">classify_geo(X,</span> <span class="pre">k,</span> <span class="pre">seed)</span></code>, that takes an array of geographical data, <code class="docutils literal notranslate"><span class="pre">X</span></code>, and does the following:</p>
<ol class="arabic simple">
<li><p>Convert the geographical data, <code class="docutils literal notranslate"><span class="pre">X</span></code>, to 3-dimensional Euclidean coordinates</p></li>
<li><p>Fit a K-means classifier on the Euclidean data with the given <code class="docutils literal notranslate"><span class="pre">k</span></code> and <code class="docutils literal notranslate"><span class="pre">seed</span></code></p></li>
<li><p>Predict the clusters for the Euclidean data with the fitted classifier</p></li>
<li><p>Convert the <code class="docutils literal notranslate"><span class="pre">centers</span></code> from the fitted classifier to longitudinal and latitudinal coordinates</p></li>
<li><p>Plot the original data, <code class="docutils literal notranslate"><span class="pre">X</span></code>, colored by its classification labels.</p></li>
</ol>
<p>Make sure to set <code class="docutils literal notranslate"><span class="pre">normalize=True</span></code> for your K-means classifier and to use <code class="docutils literal notranslate"><span class="pre">seed=42</span></code>. Use <code class="docutils literal notranslate"><span class="pre">np.load</span></code> to read <code class="docutils literal notranslate"><span class="pre">.npy</span></code> files and <code class="docutils literal notranslate"><span class="pre">np.loadtxt</span></code> to read <code class="docutils literal notranslate"><span class="pre">.txt</span></code> files into a <code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code>.</p>
</section>
<section id="color-quantization">
<h2 id="color-quantization">Color Quantization<a class="headerlink" href="#color-quantization" title="Link to this heading">¶</a></h2>
<p>The k-means algorithm uses the euclidean metric, so it is natural to cluster geographic data.
However, clustering can be done in any abstract vector space. The following application is one example.</p>
<p>Images are usually represented on computers as 3-dimensional arrays.
Each 2-dimensional layer represents the red, green, and blue color values, so each pixel on the image is really a vector in <span class="math notranslate nohighlight">\(\mathbb R^3\)</span>.
Clustering the pixels in RGB space leads a one kind of image segmentation that facilitate memory reduction.
(If you would like to read more – go to <a class="reference external" href="https://en.wikipedia.org/wiki/Color_quantization">https://en.wikipedia.org/wiki/Color_quantization</a>)</p>
</section>
<section id="task-5a">
<h2 id="task-5a">Task 5a<a class="headerlink" href="#task-5a" title="Link to this heading">¶</a></h2>
<p>Write a function, <code class="docutils literal notranslate"><span class="pre">quantize_image(X,</span> <span class="pre">n_clusters,</span> <span class="pre">n_samples,</span> <span class="pre">seed)</span></code>, that takes a color image array, <code class="docutils literal notranslate"><span class="pre">X</span></code> (shape <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">3)</span></code>), a number of clusters, <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code>, and a number of samples, <code class="docutils literal notranslate"><span class="pre">n_samples</span></code>, and an optional seed for random number generation, <code class="docutils literal notranslate"><span class="pre">seed</span></code>, and does the following:</p>
<ol class="arabic simple">
<li><p>Flatten the image such that each row represents a single pixel (shape <code class="docutils literal notranslate"><span class="pre">(m</span> <span class="pre">*</span> <span class="pre">n,</span> <span class="pre">3)</span></code>)</p></li>
<li><p>Set the seed for random number generation if given (use <code class="docutils literal notranslate"><span class="pre">np.random.seed(seed)</span></code>)</p></li>
<li><p>Randomly sample <code class="docutils literal notranslate"><span class="pre">n_samples</span></code> pixels (shape <code class="docutils literal notranslate"><span class="pre">(n_samples,</span> <span class="pre">3)</span></code>) from the flattened image uniformly (use <code class="docutils literal notranslate"><span class="pre">np.random.randint</span></code>)</p></li>
<li><p>Fit a K-means classifier of <code class="docutils literal notranslate"><span class="pre">n_clusters</span></code> clusters to the random sample</p></li>
<li><p>Predict the clusters for the entire flattened image using the fitted classifier</p></li>
<li><p>Recolor the pixels in the flattened image to the coloration of their corresponding cluster centers</p></li>
<li><p>Unflatten the recolored image (shape <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">3)</span></code>)</p></li>
<li><p>Return the recolored image</p></li>
</ol>
<p>Do NOT change the original image during any part of this process (use <code class="docutils literal notranslate"><span class="pre">np.copy</span></code> or <code class="docutils literal notranslate"><span class="pre">X.copy()</span></code> before performing any of the above steps). Also, you will not need to specify the <code class="docutils literal notranslate"><span class="pre">seed</span></code> for your K-means classifier since you will set it manually. Your code will be tested using the file given in CodeBuddy.</p>
</section>
<section id="task-5b">
<h2 id="task-5b">Task 5b<a class="headerlink" href="#task-5b" title="Link to this heading">¶</a></h2>
<p>Use your code from the previous exercise to perform color quantization on one of the images in CodeBuddy until you generate an image you are satisfied with.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="lab17.html" title="Lab 17: Rearrangements of Conditionally Convergent Series"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Lab 17: Rearrangements of Conditionally Convergent Series </span>
              </div>
            </a>
          
          
            <a href="lab19.html" title="Lab 19: Plotting Vector Valued Functions"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Lab 19: Plotting Vector Valued Functions </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, Nick Andersen.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>