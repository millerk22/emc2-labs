<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Lab 20: Approximate Integration &#8212; Math 495R EMC2 Python Labs</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="_static/material.css?v=79c92029" />
    <script src="_static/documentation_options.js?v=6fefd858"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lab 21: Iterating Functions" href="lab21.html" />
    <link rel="prev" title="Lab 19: Plotting Vector Valued Functions" href="lab19.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#lab20" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Math 495R EMC2 Python Labs"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Winter EMC2 Labs</span>
          <span class="md-header-nav__topic"> Lab 20: Approximate Integration </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = ""versions.json"",
        target_loc = "../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Math 495R EMC2 Python Labs</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Math 495R EMC2 Python Labs" class="md-nav__button md-logo">
      
        <img src="_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="index.html"
       title="Math 495R EMC2 Python Labs">Winter EMC2 Labs</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
    
      <a href="SQLlab.html" class="md-nav__link">Lab 0: An Introduction to SQL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab01.html" class="md-nav__link">Lab 1: Introduction to Plotting</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab02.html" class="md-nav__link">Lab 2: Introduction to Plotting and Sequences</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab03.html" class="md-nav__link">Lab 3: Introduction to Space Curves</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab04.html" class="md-nav__link">Lab 4: Searching in a Sorted List</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab05.html" class="md-nav__link">Lab 5: Planes, Trains and Automobiles</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab06.html" class="md-nav__link">Lab 6: Sorting and Complexity of Algorithms</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab07.html" class="md-nav__link">Lab 7: Introduction to Series</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab08.html" class="md-nav__link">Lab 8: Plotting Surfaces in 3-D</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab09.html" class="md-nav__link">Lab 9: Symbolic Python and Partial Differentiation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab10.html" class="md-nav__link">Lab 10: A Very Basic Program</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab11.html" class="md-nav__link">Lab 11: Root Finding and Newtonâ€™s Method</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab12.html" class="md-nav__link">Lab 12: One-dimensional Optimization and Gradient Descent</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab13.html" class="md-nav__link">Lab 13: Exploring Sequences and Limit Points</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab14.html" class="md-nav__link">Lab 14: Riemann Sums</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab15.html" class="md-nav__link">Lab 15: Monte Carlo Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab16.html" class="md-nav__link">Lab 16: Geometry in Higher Dimensions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab17.html" class="md-nav__link">Lab 17: Rearrangements of Conditionally Convergent Series</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab18.html" class="md-nav__link">Lab 18: K-Means Clustering</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab19.html" class="md-nav__link">Lab 19: Plotting Vector Valued Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Lab 20: Approximate Integration </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Lab 20: Approximate Integration</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lab20--page-root" class="md-nav__link">Lab 20: Approximate Integration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#two-simple-methods" class="md-nav__link">Two Simple Methods</a>
        </li>
        <li class="md-nav__item"><a href="#task-1a" class="md-nav__link">Task 1a</a>
        </li>
        <li class="md-nav__item"><a href="#task-1b" class="md-nav__link">Task 1b</a>
        </li>
        <li class="md-nav__item"><a href="#two-improvements" class="md-nav__link">Two Improvements</a>
        </li>
        <li class="md-nav__item"><a href="#task-2" class="md-nav__link">Task 2</a>
        </li>
        <li class="md-nav__item"><a href="#task-3" class="md-nav__link">Task 3</a>
        </li>
        <li class="md-nav__item"><a href="#simpson-s-rule" class="md-nav__link">Simpsonâ€™s Rule</a>
        </li>
        <li class="md-nav__item"><a href="#task-4" class="md-nav__link">Task 4</a>
        </li>
        <li class="md-nav__item"><a href="#error-bound-formulas" class="md-nav__link">Error Bound Formulas</a>
        </li>
        <li class="md-nav__item"><a href="#task-5a" class="md-nav__link">Task 5a</a>
        </li>
        <li class="md-nav__item"><a href="#task-5b" class="md-nav__link">Task 5b</a>
        </li>
        <li class="md-nav__item"><a href="#task-5c" class="md-nav__link">Task 5c</a>
        </li>
        <li class="md-nav__item"><a href="#task-6" class="md-nav__link">Task 6</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/lab20.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab21.html" class="md-nav__link">Lab 21: Iterating Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab22.html" class="md-nav__link">Lab 22: Fractals with Turtle</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab23.html" class="md-nav__link">Lab 23: Finding Areas of Arbitrary Polygons</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="lab24.html" class="md-nav__link">Lab 24: Basins of Attraction</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#lab20--page-root" class="md-nav__link">Lab 20: Approximate Integration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#two-simple-methods" class="md-nav__link">Two Simple Methods</a>
        </li>
        <li class="md-nav__item"><a href="#task-1a" class="md-nav__link">Task 1a</a>
        </li>
        <li class="md-nav__item"><a href="#task-1b" class="md-nav__link">Task 1b</a>
        </li>
        <li class="md-nav__item"><a href="#two-improvements" class="md-nav__link">Two Improvements</a>
        </li>
        <li class="md-nav__item"><a href="#task-2" class="md-nav__link">Task 2</a>
        </li>
        <li class="md-nav__item"><a href="#task-3" class="md-nav__link">Task 3</a>
        </li>
        <li class="md-nav__item"><a href="#simpson-s-rule" class="md-nav__link">Simpsonâ€™s Rule</a>
        </li>
        <li class="md-nav__item"><a href="#task-4" class="md-nav__link">Task 4</a>
        </li>
        <li class="md-nav__item"><a href="#error-bound-formulas" class="md-nav__link">Error Bound Formulas</a>
        </li>
        <li class="md-nav__item"><a href="#task-5a" class="md-nav__link">Task 5a</a>
        </li>
        <li class="md-nav__item"><a href="#task-5b" class="md-nav__link">Task 5b</a>
        </li>
        <li class="md-nav__item"><a href="#task-5c" class="md-nav__link">Task 5c</a>
        </li>
        <li class="md-nav__item"><a href="#task-6" class="md-nav__link">Task 6</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="_sources/lab20.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="lab-20-approximate-integration">
<h1 id="lab20--page-root">Lab 20: Approximate Integration<a class="headerlink" href="#lab20--page-root" title="Link to this heading">Â¶</a></h1>
<p>In our chapter on integration, we focused mainly on the theory.  We defined upper and lower sums and defined a function as integrable if the supremum of the lower sums equals the infimum of the upper sums. We also (thankfully) proved a number of results that allow us to evaluate integrals without explicitly computing this supremum of the lower sums. Of course the most important of these is the Fundamental Theorem of Calculus, which allows us to compute integrals by finding antiderivatives. Alas, many important functions do not have elementary antiderivatives and many others have antiderivatives that are hard to find. Thus it is important to have numerical procedures for approximating integrals. In this lab you will write code for the most basic algorithms for approximate integration and compare their results.</p>
<p>A word on hypotheses: Algorithms for approximate integration can only be expected to work on integrable functions. If a function is continuous on a closed and bounded interval, it is integrable. Less well-behaved functions can also be integrable, such as bounded monotone functions or bounded functions which are continuous except on a set of measure zero. Before you use any numerical techniques to approximate an integral, verify that your function is in fact integrable. All the functions considered in this lab are integrable.</p>
<section id="two-simple-methods">
<h2 id="two-simple-methods">Two Simple Methods<a class="headerlink" href="#two-simple-methods" title="Link to this heading">Â¶</a></h2>
<p>Let <span class="math notranslate nohighlight">\(f\)</span> be an integrable function on the closed interval <span class="math notranslate nohighlight">\([a,b]\)</span>.  The two simplest ways to approximate an integral are the <em>left endpoint rule</em> and the <em>right endpoint rule</em>. For both of these methods, we begin by dividing the interval of integration <span class="math notranslate nohighlight">\([a,b]\)</span> into <span class="math notranslate nohighlight">\(n\)</span> subintervals of equal length. For the left endpoint approximation <span class="math notranslate nohighlight">\(L_n\)</span>, we approximate <span class="math notranslate nohighlight">\(\int_a^b f(x) \, dx\)</span> by a Riemann sum using as sample points the left endpoints of the intervals. Similarly for the right endpoint approximation <span class="math notranslate nohighlight">\(R_n\)</span>, we use as sample points the right endpoints of the subintervals.</p>
</section>
<section id="task-1a">
<h2 id="task-1a">Task 1a<a class="headerlink" href="#task-1a" title="Link to this heading">Â¶</a></h2>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">left_riemann_sum(f,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">n)</span></code> that take as parameters a function <code class="docutils literal notranslate"><span class="pre">f</span></code>, the lower bound <code class="docutils literal notranslate"><span class="pre">a</span></code> and upper bound <code class="docutils literal notranslate"><span class="pre">b</span></code> for the interval of integration <span class="math notranslate nohighlight">\([a,b]\)</span>, and an integer <code class="docutils literal notranslate"><span class="pre">n</span></code> for the number of subintervals, and returns the left endpoint approximation to <span class="math notranslate nohighlight">\(\int_a^b f(x)\, dx\)</span>.</p>
</section>
<section id="task-1b">
<h2 id="task-1b">Task 1b<a class="headerlink" href="#task-1b" title="Link to this heading">Â¶</a></h2>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">right_riemann_sum(f,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">n)</span></code> that take as parameters a function <code class="docutils literal notranslate"><span class="pre">f</span></code>, the lower bound <code class="docutils literal notranslate"><span class="pre">a</span></code> and upper bound <code class="docutils literal notranslate"><span class="pre">b</span></code> for the interval of integration <span class="math notranslate nohighlight">\([a,b]\)</span>, and an integer <code class="docutils literal notranslate"><span class="pre">n</span></code> for the number of subintervals, and returns the right endpoint approximation to <span class="math notranslate nohighlight">\(\int_a^b f(x)\, dx\)</span>.</p>
</section>
<section id="two-improvements">
<h2 id="two-improvements">Two Improvements<a class="headerlink" href="#two-improvements" title="Link to this heading">Â¶</a></h2>
<p>The <em>midpoint rule</em> and the <em>trapezoid rule</em> are about as easy to use as the left endpoint and right endpoint rules but they have the advantage of increased accuracy. Furthermore, in the case in which the function being integrated is at least twice continuously differentiable, they come with associated error bound formulas that can further help us pin down the value of the integral.</p>
<p>As above, begin with an integrable function <span class="math notranslate nohighlight">\(f\)</span> on the closed interval <span class="math notranslate nohighlight">\([a,b]\)</span>. Subdivide the interval into <span class="math notranslate nohighlight">\(n\)</span> subintervals of equal length.  For the midpoint approximation <span class="math notranslate nohighlight">\(M_n\)</span>, use as the sample points in the Riemann sum the midpoint of each interval. For the trapezoid approximation <span class="math notranslate nohighlight">\(T_n\)</span>, take the average of the left-enpoint approximation <span class="math notranslate nohighlight">\(L_n\)</span> and the right-endpoint approximation <span class="math notranslate nohighlight">\(R_n\)</span>.</p>
</section>
<section id="task-2">
<h2 id="task-2">Task 2<a class="headerlink" href="#task-2" title="Link to this heading">Â¶</a></h2>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">trapezoid_sum(f,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">n)</span></code> that take as parameters a function <code class="docutils literal notranslate"><span class="pre">f</span></code>, the lower bound <code class="docutils literal notranslate"><span class="pre">a</span></code> and upper bound <code class="docutils literal notranslate"><span class="pre">b</span></code> for the interval of integration <code class="docutils literal notranslate"><span class="pre">[a,b]</span></code>, and an integer <code class="docutils literal notranslate"><span class="pre">n</span></code> for the number of subintervals and returns the trapezoid approximation to <span class="math notranslate nohighlight">\(\int_a^b f(x)\, dx\)</span>.</p>
</section>
<section id="task-3">
<h2 id="task-3">Task 3<a class="headerlink" href="#task-3" title="Link to this heading">Â¶</a></h2>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">midpoint_sum(f,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">n)</span></code> that take as parameters a function <code class="docutils literal notranslate"><span class="pre">f</span></code>, the lower bound <code class="docutils literal notranslate"><span class="pre">a</span></code> and upper bound <code class="docutils literal notranslate"><span class="pre">b</span></code> for the interval of integration <code class="docutils literal notranslate"><span class="pre">[a,b]</span></code>, and an integer <code class="docutils literal notranslate"><span class="pre">n</span></code> for the number of subintervals and returns the midpoint approximation to <span class="math notranslate nohighlight">\(\int_a^b f(x)\, dx.\)</span></p>
</section>
<section id="simpson-s-rule">
<h2 id="simpson-s-rule">Simpsonâ€™s Rule<a class="headerlink" href="#simpson-s-rule" title="Link to this heading">Â¶</a></h2>
<p>The approximation strategies discussed so far are similar in that they all essentially replace the function we wish to integrate with a piece-wise linear (often actually piece-wise constant) function.  One could image other schemes of approximating a function by simpler functions. <em>Simpsonâ€™s rule</em> uses the fact that through any three points on the graph of a function, there is a unique function of degree at most two whose graph also passes through these points.</p>
<p>Let <span class="math notranslate nohighlight">\(f\)</span> be an integrable function on the interval <span class="math notranslate nohighlight">\([a,b]\)</span>. <em>For</em> <span class="math notranslate nohighlight">\(n\)</span> <em>even</em>,  subdivide the interval <span class="math notranslate nohighlight">\([a,b]\)</span> into <span class="math notranslate nohighlight">\(n\)</span> subintervals <span class="math notranslate nohighlight">\([x_{i-1},x_i]\)</span> of equal length.  Now take <em>pairs</em> of consecutive intervals <span class="math notranslate nohighlight">\([x_{i-1},x_i]\)</span> and <span class="math notranslate nohighlight">\([x_i,x_{i+1}]\)</span> and approximate <span class="math notranslate nohighlight">\(f\)</span> on this pair of intervals by a quadratic function passing through <span class="math notranslate nohighlight">\((x_{i-1},f(x_{i-1}))\)</span>, <span class="math notranslate nohighlight">\((x_i,f(x_i))\)</span>, and <span class="math notranslate nohighlight">\((x_{i+1},f(x_{i+1}))\)</span>.  By integrating this quadratic function, we find that <span class="math notranslate nohighlight">\(\int_a^b f(x) \,dx\)</span> can be approximated by</p>
<div class="math notranslate nohighlight">
\[S_n=\frac{1}{3}\cdot \frac{b-a}{n}[f(x_0)+4f(x_1)+2f(x_2)+4f(x_3)+\ldots +2f(x_{n-2})+4f(x_{n-1})+f(x_n)].\]</div>
<p>It is a good idea to go through the derivation of this formula at least once in your life. See <a class="reference external" href="https://www.stewartcalculus.com/data/default/upfiles/09631_ApproximateIntegration_ptg1_hr_stu_001-022.pdf">Section 7.7 of Stewart</a>.</p>
</section>
<section id="task-4">
<h2 id="task-4">Task 4<a class="headerlink" href="#task-4" title="Link to this heading">Â¶</a></h2>
<p>Write the formula for <code class="docutils literal notranslate"><span class="pre">S_n</span></code> in summation notation.
<em>Hint</em>: one can view <span class="math notranslate nohighlight">\(S_n\)</span> as a sum of terms of the form <span class="math notranslate nohighlight">\(y_{2j-2}+4y_{2j-1}+y_{2j}.\)</span></p>
<p>Write a function <code class="docutils literal notranslate"><span class="pre">simpsons_rule_sum(f,</span> <span class="pre">a,</span> <span class="pre">b,</span> <span class="pre">n)</span></code> that takes as parameters a function <code class="docutils literal notranslate"><span class="pre">f</span></code>, the lower bound <code class="docutils literal notranslate"><span class="pre">a</span></code> and upper bound <code class="docutils literal notranslate"><span class="pre">b</span></code> for the interval of integration <span class="math notranslate nohighlight">\([a,b]\)</span>, and an integer <code class="docutils literal notranslate"><span class="pre">n</span></code> for the number of subintervals and returns the Simpsonâ€™s rule approximation to <span class="math notranslate nohighlight">\(\int_a^b f(x)\, dx\)</span>. Raise a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> if <code class="docutils literal notranslate"><span class="pre">n</span></code> is not even (use <code class="docutils literal notranslate"><span class="pre">f"n</span> <span class="pre">{(n)}</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">even"</span></code>)</p>
</section>
<section id="error-bound-formulas">
<h2 id="error-bound-formulas">Error Bound Formulas<a class="headerlink" href="#error-bound-formulas" title="Link to this heading">Â¶</a></h2>
<p>For the midpoint rule, the trapezoid rule, and Simpsonâ€™s rule, there are formulas that give an upper bound on the error associated with using the method to approximate <span class="math notranslate nohighlight">\(\int_a^b f(x)\,dx\)</span>.  These formulas are in terms of the length of the interval, the number <span class="math notranslate nohighlight">\(n\)</span> of subintervals used, and a bound on the absolute value of some derivative of <span class="math notranslate nohighlight">\(f\)</span> on <span class="math notranslate nohighlight">\([a,b]\)</span>. (Thus you should only use these formulas when <span class="math notranslate nohighlight">\(f\)</span> has the appropriate number of derivatives.)</p>
<p>Suppose that <span class="math notranslate nohighlight">\(E_M\)</span>, <span class="math notranslate nohighlight">\(E_T\)</span>, and <span class="math notranslate nohighlight">\(E_S\)</span> are the errors for the midpoint rule, trapezoid rule, and Simpsonâ€™s rule, respectively.</p>
<p>First, that <span class="math notranslate nohighlight">\(\left\vert f''(x) \right\vert \leq K\)</span> for <span class="math notranslate nohighlight">\(a \leq x \leq b\)</span>. Then we have the following bounds for the errors for the midpoint and trapezoid rules.</p>
<p>For the midpoint rule:</p>
<div class="math notranslate nohighlight">
\[|E_M|\leq \frac{K(b-a)^3}{24 n^2}.\]</div>
<p>For the trapezoid rule:</p>
<div class="math notranslate nohighlight">
\[|E_T|\leq \frac{K(b-a)^3}{12 n^2}.\]</div>
<p>Now suppose that <span class="math notranslate nohighlight">\(\left\vert f^{(4)}(x) \right\vert \leq K\)</span> for <span class="math notranslate nohighlight">\(a \leq x \leq b\)</span>. Then we have the following bound for the error for Simpsonâ€™s rule.</p>
<div class="math notranslate nohighlight">
\[|E_S|\leq \frac{K(b-a)^5}{180 n^4}.\]</div>
</section>
<section id="task-5a">
<h2 id="task-5a">Task 5a<a class="headerlink" href="#task-5a" title="Link to this heading">Â¶</a></h2>
<p>Use the trapezoid error bound formula to find an error bound on the trapezoid approximation of the integral of <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">np.exp(-x</span> <span class="pre">**</span> <span class="pre">2)</span></code> on <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0.5]</span></code> for <code class="docutils literal notranslate"><span class="pre">10</span></code> sub-intervals. Take <code class="docutils literal notranslate"><span class="pre">K</span></code> as the maximum of <code class="docutils literal notranslate"><span class="pre">|f''|</span></code> on <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0.5]</span></code> (which is an integer in this case). Write your answer as a fraction in simplest terms. Format your answer EXACTLY as follows: <code class="docutils literal notranslate"><span class="pre">numerator</span></code> / <code class="docutils literal notranslate"><span class="pre">denominator</span></code>.</p>
</section>
<section id="task-5b">
<h2 id="task-5b">Task 5b<a class="headerlink" href="#task-5b" title="Link to this heading">Â¶</a></h2>
<p>Use the midpoint error bound formula to find an error bound on the midpoint approximation of the integral of <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">np.exp(-x</span> <span class="pre">**</span> <span class="pre">2)</span></code> on <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0.5]</span></code> for <code class="docutils literal notranslate"><span class="pre">10</span></code> sub-intervals. Take <code class="docutils literal notranslate"><span class="pre">K</span></code> as the maximum of <code class="docutils literal notranslate"><span class="pre">|f''|</span></code> on <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0.5]</span></code> (which is an integer in this case). Write your answer as a fraction in simplest terms. Format your answer EXACTLY as follows: <code class="docutils literal notranslate"><span class="pre">numerator</span></code> / <code class="docutils literal notranslate"><span class="pre">denominator</span></code>.</p>
</section>
<section id="task-5c">
<h2 id="task-5c">Task 5c<a class="headerlink" href="#task-5c" title="Link to this heading">Â¶</a></h2>
<p>Use the Simponâ€™s error bound formula to find an error bound on Simponâ€™s approximation of the integral of <code class="docutils literal notranslate"><span class="pre">f</span> <span class="pre">=</span> <span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">np.exp(-x</span> <span class="pre">**</span> <span class="pre">2)</span></code> on <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0.5]</span></code> for <code class="docutils literal notranslate"><span class="pre">10</span></code> sub-intervals. Take <code class="docutils literal notranslate"><span class="pre">K</span></code> as the maximum of <code class="docutils literal notranslate"><span class="pre">|f''''|</span></code> on <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0.5]</span></code> (which is an integer in this case). Write your answer as a fraction in simplest terms. Format your answer EXACTLY as follows: <code class="docutils literal notranslate"><span class="pre">numerator</span></code> / <code class="docutils literal notranslate"><span class="pre">denominator</span></code>.</p>
</section>
<section id="task-6">
<h2 id="task-6">Task 6<a class="headerlink" href="#task-6" title="Link to this heading">Â¶</a></h2>
<p>The true value of <span class="math notranslate nohighlight">\(\int_1^5 \frac{1}{x} \,dx\)</span> is <span class="math notranslate nohighlight">\(\ln 5\)</span>. Use all five approximation methods to approximate the integral with <span class="math notranslate nohighlight">\(n=10\)</span>. For each method, compute the true error. For the midpoint, trapezoid, and Simpsonâ€™s rules, check that the error bounds are larger than the absolute value of the true error.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="lab19.html" title="Lab 19: Plotting Vector Valued Functions"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Lab 19: Plotting Vector Valued Functions </span>
              </div>
            </a>
          
          
            <a href="lab21.html" title="Lab 21: Iterating Functions"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Lab 21: Iterating Functions </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, Nick Andersen.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>